<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="application/javascript" src="../index.js"></script>
    <script>
        var queue = [];
        var enqueue = [].unshift.bind(queue);
        var dequeue = [].pop.bind(queue);

        var lazilyEnqueue = lazyEnqueue(enqueue, {
            delay: 1000,
            limit: 3,
            dequeue: dequeue,
            will: function (data) {
                console.group()
                console.timeEnd('time')
                console.log('will enqueue:', data)
            },
            failed: function (err, data) {
                console.warn('failed enqueue:', data, ', and the reason is', err)
            },
            did: function (value, data) {
                console.log('queue:', queue);
                console.groupEnd()
            }
        })
        console.time('time')
        lazilyEnqueue(0);lazilyEnqueue(1);
        setTimeout(function () {
            lazilyEnqueue(2);lazilyEnqueue(3);lazilyEnqueue(4);lazilyEnqueue(5);
        }, 2000)
        setTimeout(function () {
            lazilyEnqueue(6).delay(500).hook('will', function (data) {
                console.info('will hook, delay 500')
                return '6.1'
            });
            lazilyEnqueue(7).delay(2000).hook('did', function (value, data) {
                console.info('did hook, delay 2000')
            }).hook('will', function (data) {
                return 'origin data:' + data
            }).hook('will', function (data) {
            });
            lazilyEnqueue(8);
        }, 3500)
    </script>
</head>
<body>

</body>
</html>